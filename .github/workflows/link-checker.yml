name: Link Check

on:
  schedule:
    - cron: "00 00 * * 1"

  # Runs on each PR
  pull_request:
    branches:
      - "master"
      - 'main'
  # Runs on each push
  push:
    branches:
      - 'main'
      - 'master'


jobs:
  Checking-Links:
    runs-on: ubuntu-latest
    steps:
      # Checks out a copy of your repository on the ubuntu-latest machine
      - name: Checkout code
        uses: actions/checkout@v4

      # Building the docs
      # - name: Build the docs
      #   uses: actions/setup-node@v3
      #   with:
      #     node-version: 16
      # - run: npm run build

      # Run link checker on the generated HTML
      - name: Link Checker
        id: lychee
        uses: lycheeverse/lychee-action@fdea7032675810093199f485fe075f057cc37b3e # 1.8.0
        with:
          fail: true
          args: >
            --config ./lychee.toml
            --cache --max-cache-age 1d
            README.md

      # - name: Create Issue From File
      #   if: |
      #     github.event_name != 'pull_request' &&
      #     env.lychee_exit_code != 0
      #   uses: peter-evans/create-issue-from-file@v4
      #   with:
      #     title: Link Checker Report
      #     content-filepath: ./lychee/out.md
      #     labels: good-first-issue, automated issue